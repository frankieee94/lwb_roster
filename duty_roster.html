<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon192.png">
  <link rel="apple-touch-icon" href="icon192.png">
  <!-- Open Graph (for Facebook, WhatsApp, LinkedIn) -->
  <meta property="og:title" content="龍運羊仔 - 值更時間表">
  <meta property="og:description" content="每日自動更新的龍運羊仔更表，可篩選出勤狀態、路線、更份等資料">
  <meta property="og:image" content="https://frankieee94.github.io/lwb_roster/thumbnail-v2.png">
  <meta property="og:url" content="https://frankieee94.github.io/lwb_roster/duty_roster.html">
  <meta property="og:type" content="website">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="龍運羊仔 - 值更時間表">
  <meta name="twitter:description" content="每日自動更新的龍運羊仔更表，可篩選出勤狀態、路線、更份等資料">
  <meta name="twitter:image" content="https://frankieee94.github.io/lwb_roster/thumbnail-v2.png">
  <title>龍運 - 羊仔更表</title>
  <style>
    body {
      font-family: 'PingFang TC', 'Noto Sans TC', sans-serif;
      background-color: #f9f9f9;
    }
    .filters {
      margin-bottom: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      font-size: 14px;
    }
    .filters label {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .filters select {
      font-size: 14px;
      padding: 3px;
    }
    .last-update {
      font-size: 14px;
      color: #666;
      margin-bottom: 1.5rem;
    }
    .table-container {
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: white;
      min-width: 1000px;
    }
    td, th {
      border: 1px solid #ccc;
      padding: 6px;
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>龍運 - 羊仔更表</h1>
  <div class="last-update">最後更新時間(香港)：2025/11/13 01:43</div>

  <div class="filters">
    <label>編更廠：
      <select id="filter-depot"><option value="">全部</option></select>
    </label>
    <label>路線：
      <select id="filter-route"><option value="">全部</option></select>
    </label>
    <label>字軌：
      <select id="filter-code"><option value="">全部</option></select>
    </label>
    <label>更份：
      <select id="filter-shift"><option value="">全部</option></select>
    </label>
    <label>簽到地點：
      <select id="filter-checkin"><option value="">全部</option></select>
    </label>
    <label>出勤狀態（可多選）：
      <select id="filter-location" multiple size="4"></select>
    </label>
  </div>

  <div class="table-container">
    <table bgcolor="#C6C6FF" border="1" cellpadding="2" width="1000"><thead><tr align="center" bgcolor="#AAAAFF">
<td width="180"><font size="2">更牌日期(年/月/日)</font></td>
<td width="80"><font size="2">編更廠</font></td>
<td width="50"><font size="2">路線</font></td>
<td width="50"><font size="2">字軌</font></td>
<td width="40"><font size="2">更份</font></td>
<td width="80"><font size="2">候命時間</font></td>
<td width="80">簽到地點</td>
<td width="150">出勤狀態</td>
<td width="80"><font size="2">備註</font></td>
<td width="80"><font size="2"> </font></td>
<td width="80"><font size="2">曾經更新</font></td>
<td width="100"><font size="2">事假/調假申請</font></td>
</tr></thead><tbody><tr style="background-color: #FFF6D5;"><td><font color="#FF0000" size="2">2025/11/12 (星期三)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/13 (星期四)</font></td>
<td><font color="#000000" size="2">龍運石湖墟廠</font></td>
<td><font color="#000000" size="2">A43</font></td>
<td><font color="#000000" size="2">L23</font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2">13:30</font></td>
<td><font color="#000000" size="2">聯和墟</font></td>
<td><font color="#000000" size="2">正常</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">*</font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/14 (星期五)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/15 (星期六)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/16 (星期日)#</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/17 (星期一)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/18 (星期二)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/19 (星期三)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/20 (星期四)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/21 (星期五)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/22 (星期六)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/23 (星期日)#</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/24 (星期一)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">*</font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/25 (星期二)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/26 (星期三)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/27 (星期四)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#000000" size="2">2025/11/28 (星期五)</font></td>
<td><font color="#000000" size="2">龍運元朗廠</font></td>
<td><font color="#000000" size="2"> </font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">夜</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2">後備</font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
<td><font color="#000000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/29 (星期六)</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr><tr><td><font color="#FF0000" size="2">2025/11/30 (星期日)#</font></td>
<td><font color="#FF0000" size="2">龍運元朗廠</font></td>
<td><font color="#FF0000" size="2"> </font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">夜</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">編休</font></td>
<td><font color="#FF0000" size="2"></font></td>
<td><font color="#FF0000" size="2">*</font></td>
<td><font color="#FF0000" size="2"></font></td>
</tr></tbody></table>
  </div>

  <script>
    const columnIndexMap = {
      depot: 1,
      route: 2,
      code: 3,
      shift: 4,
      checkin: 6,
      location: 7
    };

    function getUniqueColumnValues(index) {
      const rows = Array.from(document.querySelectorAll("table tbody tr")).slice(1);
      const values = new Set();
      rows.forEach(row => {
        const cell = row.cells[index];
        if (cell && cell.textContent.trim()) {
          values.add(cell.textContent.trim());
        }
      });
      return Array.from(values).sort();
    }

    function populateFilter(id, values) {
      const select = document.getElementById(id);
      if (id === "filter-location") {
        const allOption = document.createElement("option");
        allOption.value = "__ALL__";
        allOption.textContent = "全部";
        select.appendChild(allOption);
      }
      values.forEach(val => {
        const option = document.createElement("option");
        option.value = val;
        option.textContent = val;
        select.appendChild(option);
      });
    }

    function getMultiSelectValues(selectElement) {
      const selected = Array.from(selectElement.selectedOptions).map(opt => opt.value);
      if (selected.includes("__ALL__")) {
        // 揀咗「全部」就取返所有非 "全部" 嘅選項
        return Array.from(selectElement.options)
                    .map(opt => opt.value)
                    .filter(v => v && v !== "__ALL__");
      }
      return selected;
    }

    function applyFilters() {
      const filters = {
        depot: document.getElementById("filter-depot").value,
        route: document.getElementById("filter-route").value,
        code: document.getElementById("filter-code").value,
        shift: document.getElementById("filter-shift").value,
        checkin: document.getElementById("filter-checkin").value,
        location: getMultiSelectValues(document.getElementById("filter-location"))
      };
      const rows = document.querySelectorAll("table tbody tr");
      rows.forEach(row => {
        let visible = true;
        for (const key in filters) {
          const val = filters[key];
          const cell = row.cells[columnIndexMap[key]];
          const text = cell ? cell.textContent.trim() : "";

          if (key === "location") {
            if (val.length && !val.includes(text)) {
              visible = false;
              break;
            }
          } else {
            if (val && text !== val) {
              visible = false;
              break;
            }
          }
        }
        row.style.display = visible ? "" : "none";
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      const keys = ["depot", "route", "code", "shift", "checkin", "location"];
      keys.forEach(key => {
        const filterId = "filter-" + key;
        const values = getUniqueColumnValues(columnIndexMap[key]);
        populateFilter(filterId, values);

        // 預設選中「全部」
        if (key === "location") {
          document.getElementById(filterId).querySelector("option[value='__ALL__']").selected = true;
        }

        document.getElementById(filterId).addEventListener("change", applyFilters);
      });
    });
  </script>
</body>
</html>
